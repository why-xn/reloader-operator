# Production values for reloader-operator
# Recommended settings for production environments

replicaCount: 2

image:
  repository: stakater/reloader-operator
  pullPolicy: IfNotPresent
  tag: "2.0.0"

# Resource limits for production
resources:
  limits:
    cpu: 1000m
    memory: 512Mi
  requests:
    cpu: 200m
    memory: 128Mi

# Enable high availability with leader election
operator:
  logLevel: info
  leaderElection:
    enabled: true
    leaseDuration: 15s
    renewDeadline: 10s
    retryPeriod: 2s
  syncPeriod: 5m
  maxConcurrentReconciles: 3

# Enable metrics and monitoring
metrics:
  enabled: true
  port: 8080
  path: /metrics

# Enable Prometheus ServiceMonitor
serviceMonitor:
  enabled: true
  additionalLabels:
    prometheus: kube-prometheus
  interval: 30s
  scrapeTimeout: 10s

# Pod disruption budget for high availability
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Horizontal pod autoscaling
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# Security hardening
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532
  fsGroup: 65532
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

# Network policy (optional - configure based on your needs)
networkPolicy:
  enabled: false
  # ingress:
  # - from:
  #   - namespaceSelector:
  #       matchLabels:
  #         name: monitoring
  #   ports:
  #   - protocol: TCP
  #     port: 8080
  # egress:
  # - to:
  #   - namespaceSelector: {}
  #   ports:
  #   - protocol: TCP
  #     port: 6443  # Kubernetes API

# Priority class for critical workloads
priorityClassName: "system-cluster-critical"

# Affinity for better distribution
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
    - weight: 100
      podAffinityTerm:
        labelSelector:
          matchExpressions:
          - key: app.kubernetes.io/name
            operator: In
            values:
            - reloader-operator
        topologyKey: kubernetes.io/hostname

# Alerting configuration (configure with your webhook URLs)
alerts:
  enabled: true
  slack:
    enabled: true
    # Store webhook URL in a secret for security
    webhookURLSecret:
      name: reloader-slack-webhook
      key: webhook-url
    username: "Reloader Operator - Production"
    icon: ":warning:"

# Additional labels for all resources
commonLabels:
  environment: production
  team: platform
